webpackJsonp([1],{ACH5:function(e,t){},AGpY:function(e,t){},AJJt:function(e,t){},"DbD+":function(e,t){},KxOn:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("pFYg"),r=n.n(a),s=n("7+uW"),i={render:function(){var e=this.$createElement;return(this._self._c||e)("router-view")},staticRenderFns:[]};var o=n("VU/8")({name:"App"},i,!1,function(e){n("AJJt")},"data-v-c3603fec",null).exports,c=n("/ocq"),u=n("mvHQ"),d=n.n(u),l={name:"drawing-board",props:["currentGameValues","config"],data:function(){return{width:.9*window.innerWidth,height:.9*window.innerHeight}},computed:{},methods:{draw:function(e){var t=document.getElementById("canvas").getContext("2d");console.log("in draw"),console.log(e);var n=window.innerWidth/e.drawingViewport.width,a=window.innerHeight/e.drawingViewport.height;t.lineTo(e.coordinates.x*n,e.coordinates.y*a),t.strokeStyle=e.strokeStyle,t.lineWidth=e.lineWidth,t.stroke()},moveContext:function(e){console.log("in move context");var t=document.getElementById("canvas").getContext("2d"),n=window.innerWidth/e.drawingViewport.width,a=window.innerHeight/e.drawingViewport.height;t.beginPath(),t.moveTo(e.coordinates.x*n,e.coordinates.y*a)},endPath:function(e){document.getElementById("canvas").getContext("2d").closePath()}},ready:function(){var e=document.getElementById("canvas").getContext("2d");e.translate(.5,.5),e.imageSmoothingEnabled=!1}},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"drawing-board"},[n("div",{attrs:{id:"current-round-info"}},[n("span",{staticClass:"info-display"},[e._v("Round "+e._s(e.currentGameValues.currentRound)+" / "+e._s(e.config.maxRounds))]),e._v(" "),n("span",{staticClass:"info-display",attrs:{id:"current-word-display"}},[e._v(e._s(e.currentGameValues.maskedWord))]),e._v(" "),n("span",{staticClass:"info-display"},[e._v(e._s(e.currentGameValues.timer))])]),e._v(" "),n("div",{attrs:{id:"canvas-container"}},[n("canvas",{attrs:{width:e.width,height:e.height,id:"canvas"}})])])},staticRenderFns:[]};var m=n("VU/8")(l,h,!1,function(e){n("KxOn")},"data-v-7a1ad159",null).exports,p=n("Gu7T"),f=n.n(p),g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"intermediate-screen"},[t("h1",{attrs:{id:"msg"}},[this._v(this._s(this.msg.toUpperCase()))])])},staticRenderFns:[]};var v=n("VU/8")({name:"intermediate-screen",props:["msg"]},g,!1,function(e){n("AGpY")},"data-v-180b071f",null).exports,y={name:"game",components:{DrawingBoard:m,IntermediateScreen:v},data:function(){return{gamePhase:-1,players:S.players,wordlist:["testword","supertest","superultratest"],config:{guessTeamSize:2,drawTeamSize:2,roundTimeSec:30,maxRounds:10},currentGameValues:{currentWord:"",maskedWord:"",currentRound:0,guessTeams:[],drawTeam:[],timer:0}}},mounted:function(){console.log("players at game mounted : "+this.players.length);var e=this;document.addEventListener("setConfig",function(t){e.setGameConfig(t.detail)}),document.addEventListener("startRound",function(t){e.startRound()})},methods:{startRound:function(){var e=this;this.currentGameValues.currentRound++,this.gamePhase=0,this.buildTeams(),console.log("after build teams",this.players.length),this.selectWord(),this.maskWord(),this.setTimer(),setTimeout(function(){e.gamePhase=1;for(var t=0;t<e.players.length;t++)e.players[t].send(d()({action:"setGamePhase",payload:1}));e.startTimer()},3e3)},startTimer:function(){var e=this;this.gamephase=1;var t=setInterval(function(){e.currentGameValues.timer>0?e.currentGameValues.timer--:(clearInterval(t),e.endRound())},1e3)},endRound:function(){var e=this;this.gamePhase;for(var t=0;t<this.players.length;t++)this.players[t].send(d()({action:"setGamePhase",payload:2}));this.currentGameValues.currentRound==this.config.maxRounds&&this.gameover(),setTimeout(function(){e.startRound()},2e3)},gameOver:function(){this.gamestate=3;for(var e=0;e<this.players.length;e++)this.players[e].send(d()({action:"setGamePhase",payload:3}))},setTimer:function(){this.currentGameValues.timer=this.config.roundTimeSec},maskWord:function(){for(var e=[],t=0;t<this.currentGameValues.currentWord.length;t++)e.push("_");this.currentGameValues.maskedWord=e.join("")},unMaskWord:function(){for(var e=this.currentGameValues.timer/this.config.roundTimeSec,t=Math.random(),n=[],a=0;a<this.currentGameValues.currentWord.length;a++)t>e?"_"==this.currentGameValues.maskedWord.charAt(a)?n.push(this.currentGameValues.currentWord.charAt(a)):n.push("_"):"_"==this.currentGameValues.maskedWord.charAt(a)&&n.push(this.currentGameValues.maskedWord.charAt(a));this.currentGameValues.maskedWord=n.join("")},setGameConfig:function(e){this.config.guessTeamSize=e.guessTeamSize,this.config.drawTeamSize=e.drawTeamSize,this.config.roundTimeSec=e.roundTimeSec,this.config.maxRounds=e.maxRounds,this.players.forEach(function(e){e.send(d()({action:"startRound"}))}),console.log("game config 3 "+this.players.length)},shuffle:function(e){for(var t,n,a=e.length;a;t=Math.floor(Math.random()*a),n=e[--a],e[a]=e[t],e[t]=n);return e},selectWord:function(){var e=Math.floor(Math.random()*this.wordlist.length);this.currentGameValues.currentWord=this.wordlist[e]},buildTeams:function(){for(var e=[].concat(f()(this.players)),t=this.shuffle(e),n=0;n<=this.config.drawTeamSize;n++){if(!(t.length>0)){console.log("draw teams not enough players");break}var a=Math.floor(Math.random()*t.length),r=t[a];this.currentGameValues.drawTeam.push(r),t.splice(a,1),console.log("ranplayer",r),r.send(d()({action:"assignTeam",payload:"draw"}))}for(var s=Math.floor(this.players.length/this.config.guessTeamSize),i=0;i<=s;i++){var o=[];for(n=0;n<=this.config.guessTeamSize;n++){if(!(t.length>0)){console.log("guess teams not enough players");break}var c=Math.floor(Math.random()*t.length),u=t[c];o.push(u),t.splice(c,1),u.send(d()({action:"assignTeam",payload:"guess_"+i}))}this.currentGameValues.guessTeams.push(o)}},evaluateGuess:function(e,t){return e==this.currentGameValues.currentWord}}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"game"},[-1==e.gamePhase?n("IntermediateScreen",{attrs:{id:"preparing-screen",msg:"Create a new game!"}}):e._e(),e._v(" "),0==e.gamePhase?n("IntermediateScreen",{attrs:{id:"preparing-screen",msg:"prepare for round "+e.currentGameValues.currentRound}}):1==e.gamePhase?n("div",{attrs:{id:"game-screen"}},[n("div",{attrs:{id:"drawing-board"}},[n("DrawingBoard",{attrs:{currentGameValues:e.currentGameValues,config:e.config}})],1)]):2==e.gamePhase?n("IntermediateScreen",{attrs:{id:"round-end-screen",msg:"Round Over \n New Teams"}}):3==e.gamePhase?n("IntermediateScreen",{attrs:{id:"round-end-screen",msg:"Game Over"}}):e._e()],1)},staticRenderFns:[]};var w=n("VU/8")(y,b,!1,function(e){n("DbD+")},"data-v-531660e8",null).exports,_=[];var S={createConnection:function e(t,n,a){console.log(n),console.log(a);var r=new WebSocket(n+a);r.binaryType="arraybuffer",r.onopen=function(e){console.log("Connection "+t+" waiting ...")},r.onclose=function(e){console.log("Connection "+t+" closed.");for(var n=0;n<arr.length;n++)arr[n]===r&&_.splice(n,1)},r.onerror=function(e){console.log("Connection error.")},r.onmessage=function(s){"pairingcompleted"==s.data?(console.log("connection "+t+" paired"),_.push(r),_[0].send(d()({action:"setMaster"})),r.send(d()({action:"setConnected"})),r.onmessage=function(e){var t=JSON.parse(e.data);switch(console.log(t),t.action){case"initiateConfig":console.log("here");var n=new CustomEvent("initiateConfig");document.dispatchEvent(n);break;case"setConfig":var a=new CustomEvent("setConfig",{detail:t.payload});document.dispatchEvent(a);case"startRound":var r=new CustomEvent("startRound");document.dispatchEvent(r);break;case"draw":console.log("in switch"),m.methods.draw(t.payload);break;case"moveContext":m.methods.moveContext(t.payload);break;case"endPath":m.methods.endPath(t.payload)}},e(t+1,n,a)):(console.log("Unexpected message received from terminal."),r.close())}},players:_},C={name:"StartScreen",data:function(){return{players:S.players,msg:"Press Connect",minPlayers:0,urls:["https://media.giphy.com/media/I2sZ6qckkhfLG/giphy.gif","https://media.giphy.com/media/dQRJlzW1sK3QI/giphy.gif","https://media.giphy.com/media/BlcWQ9L2VfOFO/giphy.gif","https://media.giphy.com/media/PzY2K7SaqIEyA/giphy.gif","https://media.giphy.com/media/3oEdv5SY4LBHUBe2o8/giphy.gif","https://media.giphy.com/media/tIiSuOvQucRFkoyj4W/giphy.gif","https://media.giphy.com/media/mRAu3P4p28KoU/giphy.gif"]}},created:function(){var e=oipfObjectFactory.createCSManager().getApp2AppLocalBaseURL(),t=this.$parseParameters(location.search.substr(1)).channel||"org.mychannel.myapp";setTimeout(function(){S.createConnection(0,e,t)},1e3)},mounted:function(){var e='url("'+this.urls[Math.floor(Math.random()*this.urls.length)]+'") repeat';$(".splash").css("background",e);var t=this;document.addEventListener("initiateConfig",function(){t.startGame()})},methods:{startGame:function(){var e=this;this.players.length>=this.minPlayers?(this.msg="Let's Go!",setTimeout(function(){e.players.forEach(function(e){e.send(d()({action:"startConfig"}))}),j.push("/game?channel=org.mychannel.myapp#port=8080&hostname=141.23.185.48")},3e3)):(this.msg="You need at least 4 players!",setTimeout(function(){e.msg="drawnout.tv"},3e3))}}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"start-screen"},[n("div",{attrs:{id:"msg-box"}},[n("p",[e._v(e._s(e.msg))])]),e._v(" "),n("div",{attrs:{id:"player-count-info"}},[n("div",{staticClass:"splash"},[n("div",{staticClass:"knockout-text",attrs:{id:"player-nr"}},[e._v(e._s(e.players.length))])]),e._v(" "),1==e.players.length?n("span",[e._v("Player Connected")]):n("span",[e._v("Players Connected")])])])},staticRenderFns:[]};var O=n("VU/8")(C,T,!1,function(e){n("qeMB")},"data-v-0a633369",null).exports,V=n("162o"),P={name:"splash",data:function(){return{urls:["https://media.giphy.com/media/I2sZ6qckkhfLG/giphy.gif","https://media.giphy.com/media/dQRJlzW1sK3QI/giphy.gif","https://media.giphy.com/media/BlcWQ9L2VfOFO/giphy.gif","https://media.giphy.com/media/PzY2K7SaqIEyA/giphy.gif","https://media.giphy.com/media/3oEdv5SY4LBHUBe2o8/giphy.gif","https://media.giphy.com/media/tIiSuOvQucRFkoyj4W/giphy.gif","https://media.giphy.com/media/mRAu3P4p28KoU/giphy.gif"]}},mounted:function(){var e='url("'+this.urls[Math.floor(Math.random()*this.urls.length)]+'") repeat';$(".splash").css("background",e),Object(V.setTimeout)(function(e){$(".splash").addClass("fadeOut"),Object(V.setTimeout)(function(e){j.push("/start?channel=org.mychannel.myapp#port=8080&hostname=141.23.185.48")},300)},4e3)}},R={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"splash bigger"},[t("h2",{staticClass:"knockout-text"},[this._v("DRAWNOUT")])])}]};var G=n("VU/8")(P,R,!1,function(e){n("VZYB")},"data-v-99c056c6",null).exports;s.a.use(c.a);var j=new c.a({routes:[{path:"/",name:"Splashscreen",component:G},{path:"/start",name:"StartScreen",component:O},{path:"/game",name:"Game",component:w}]});!function(){var e=function(){h&&h.close(),(h=new WebSocket(u)).onopen=function(e){},h.onclose=function(e){(h=this)&&(h=null)},h.onerror=function(e){console.error("Error on connect to cs manager")},h.onmessage=function(e){try{var t=JSON.parse(e.data);n(t)}catch(e){console.error("Error on parsing or handling rpc response",e)}}},t=function(e,t){return e.id||(e.id=m++),!(!t||!h)&&(p[e.id]={req:e,callback:t},h.send(d()(e)),!0)},n=function(e){var t=e.id;console.log(e);var n=p[t];if(n&&n.callback)try{var a=n.req||null;n.callback.call(a,e)}catch(e){}},a=function(e){var t={};if(e=e.substr(e.lastIndexOf("#")+1))for(var n=e.split("&"),a=0;a<n.length;a++){var s=n[a].indexOf("="),i=s>-1?n[a].substr(0,s):n[a],o=s>-1?n[a].substr(s+1):"";void 0===t[i]?t[i]=o:"string"==typeof t[i]?t[i]=[t[i],o]:"object"==r()(t[i])&&t[i].push(o)}return t}(location.hash.substr(location.hash.lastIndexOf("#")+1)),s=a.port,i=a.hostname,o=s&&"ws://127.0.0.1:"+s+"/local/"||null,c=s&&i&&"ws://"+i+":"+s+"/remote/"||null,u="ws://127.0.0.1:"+s+"/hbbtvmanager",l=(navigator.userAgent,s&&i&&"http://"+i+":"+s+"/dial/apps/HbbTV"||null),h=null,m=1,p={},f=1,g={},v=1,y={},b=function(e,t,n,a,r){Object.defineProperty(this,"enum_id",{get:function(){return e}}),Object.defineProperty(this,"friendly_name",{get:function(){return t}}),Object.defineProperty(this,"X_HbbTV_App2AppURL",{get:function(){return n}}),Object.defineProperty(this,"X_HbbTV_InterDevSyncURL",{get:function(){return a}}),Object.defineProperty(this,"X_HbbTV_UserAgent",{get:function(){return r}})},w=function(e,t,n){Object.defineProperty(this,"enum_id",{get:function(){return e}}),Object.defineProperty(this,"friendly_name",{get:function(){return t}}),Object.defineProperty(this,"CS_OS_id",{get:function(){return n}})},_=function(e){return t({jsonrpc:"2.0",method:"discoverCSLaunchers",params:[]},function(t){var n=t.result,a=[];for(var r in n){var s=g[r],i=n[r];i.id=r;var o=s&&s.enum_id||f++,c=new w(o,i.friendlyName,i.csOsId);g[r]=c,g[o]=i,a.push(c)}e&&e.call(null,a)})},S=function(e){return t({jsonrpc:"2.0",method:"discoverTerminals",params:[]},function(t){var n=t.result,a=[];for(var r in n){var s=y[r],i=n[r];i.id=r;var o=s&&s.enumId||v++,c=new b(o,i.friendlyName,i.app2AppURL,i.interDevSyncURL,i.userAgent);y[r]=c,y[o]=i,a.push(c)}e&&e.call(null,a)})},C=function(e,n,a){var r=g[e],s=null;return r&&"string"==typeof n?t({jsonrpc:"2.0",method:"launchCSApp",params:[r.id,n]},function(t){var n=t.result;a&&a.call(null,e,n)}):(s=3,a&&a.call(null,e,s),!1)},T=function(e,n,a){var r=y[e],s=null;return r?t({jsonrpc:"2.0",method:"launchHbbTVApp",params:[r.id,n]},function(t){var n=t.result;a&&a.call(null,e,n)}):(s=3,a&&a.call(null,e,s),!1)},O=function(){return console.warn("HbbTVCSManager.getInterDevSyncURL is not supported yet"),""},V=function(){return l},P=function(){return o},R=function(){return c};if(s&&i){window.oipfObjectFactory=window.oipfObjectFactory||{},window.oipfObjectFactory.createCSManager=oipfObjectFactory.createCSManager||function(){return new function(){Object.defineProperty(this,"discoverCSLaunchers",{get:function(){return _}}),Object.defineProperty(this,"discoverTerminals",{get:function(){return S}}),Object.defineProperty(this,"launchCSApp",{get:function(){return C}}),Object.defineProperty(this,"launchHbbTVApp",{get:function(){return T}}),Object.defineProperty(this,"getInterDevSyncURL",{get:function(){return O}}),Object.defineProperty(this,"getAppLaunchURL",{get:function(){return V}}),Object.defineProperty(this,"getApp2AppLocalBaseURL",{get:function(){return P}}),Object.defineProperty(this,"getApp2AppRemoteBaseURL",{get:function(){return R}})}};var G=oipfObjectFactory.isObjectSupported;window.oipfObjectFactory.isObjectSupported=function(e){return"application/hbbtvCSManager"==e||G&&G.app(this,arguments)},e()}else s?(window.hbbtv=window.hbbtv||{},window.hbbtv.createTerminalManager=function(){return new function(){Object.defineProperty(this,"discoverTerminals",{get:function(){return S}}),Object.defineProperty(this,"launchHbbTVApp",{get:function(){return T}})}},e()):console.warn("hash parameters 'port' and/or 'hostname' are not detected. hbbtv-manager-polyfill.js can be used in HbbTV Apps when the hash parameters 'port' and 'hostname' are specified and in CS Web Apps when only the 'port' hash parameter is specified. These parameters will be automatically set when the HbbTV App is launched through the HbbTVDialServer or the CS Web App is launched through the CsLauncherDialServer. The hash parameters needs to be set manually if the application is launched by the user.")}();n("ACH5");s.a.config.productionTip=!1,s.a.mixin({methods:{$parseParameters:function(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var s=n[a].indexOf("="),i=s>-1?n[a].substr(0,s):n[a],o=s>-1?n[a].substr(s+1):"";void 0===t[i]?t[i]=o:"string"==typeof t[i]?t[i]=[t[i],o]:"object"==r()(t[i])&&t[i].push(o)}return t}}}),new s.a({el:"#app",router:j,components:{App:o},template:"<App/>"})},VZYB:function(e,t){},qeMB:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.479c1554dd59d17708eb.js.map